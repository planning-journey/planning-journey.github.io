# History - 2026년 1월 5일 (월요일)

## 요청 내용

할 일 목록은 현재 선택된 날짜와 날짜가 일치하는 할 일 목록만 표시할 수 있게 수정.

## 작업 내용

사용자의 요청에 따라 할 일 목록이 현재 선택된 날짜와 일치하는 할 일만 표시되도록 기능을 구현했습니다.

### 1. `src/db.ts` 파일 수정
- `Task` 인터페이스에 `date: string;` 속성을 추가했습니다. 날짜는 `YYYY-MM-DD` 형식의 문자열로 저장됩니다.
- Dexie 스키마 버전을 3에서 4로 업데이트하고, `tasks` 스토어에 `date` 속성을 인덱스로 추가하여 날짜 기반 쿼리를 효율적으로 수행할 수 있도록 했습니다.

```typescript
// src/db.ts (변경 내용 요약)
export interface Task {
  id?: number;
  text: string;
  goalId: number | null;
  completed: boolean;
  date: string; // YYYY-MM-DD format
  createdAt: Date;
}

export class MySubClassedDexie extends Dexie {
  // ...
  constructor() {
    super('planningJourneyDB');
    // ...
    this.version(4).stores({
      goals: '++id, name, startDate, endDate, createdAt',
      tasks: '++id, goalId, date, createdAt' // date 속성 추가 및 인덱싱
    });
  }
}
```

### 2. `src/utils/dateUtils.ts` 파일 추가
- 날짜를 `YYYY-MM-DD` 형식의 문자열로 변환하고, 그 반대로 파싱하는 유틸리티 함수 `formatDateToYYYYMMDD`와 `parseYYYYMMDDToDate`를 포함하는 `dateUtils.ts` 파일을 새로 생성했습니다.

```typescript
// src/utils/dateUtils.ts
export const formatDateToYYYYMMDD = (date: Date): string => { /* ... */ };
export const parseYYYYMMDDToDate = (dateString: string): Date => { /* ... */ };
```

### 3. `src/components/DailyDetailArea.tsx` 파일 수정
- `selectedDate`를 `formatDateToYYYYMMDD` 함수를 사용하여 `YYYY-MM-DD` 형식의 문자열로 변환했습니다.
- `useLiveQuery` 훅에서 `createdAt` 대신 `date` 속성을 사용하여 현재 선택된 날짜와 일치하는 할 일만 필터링하도록 쿼리를 수정했습니다.
- 새로운 할 일 추가 시 `newTask.date`에 `formattedSelectedDate`를 할당하고, `newTask.createdAt`는 `new Date()`로 설정하여 생성 시각과 할 일 날짜를 명확히 구분했습니다.

```typescript
// src/components/DailyDetailArea.tsx (변경 내용 요약)
const DailyDetailArea: React.FC<DailyDetailAreaProps> = ({ selectedDate }) => {
  // ...
  const formattedSelectedDate = formatDateToYYYYMMDD(selectedDate);

  const tasks = useLiveQuery(() =>
    db.tasks
      .where('date')
      .equals(formattedSelectedDate)
      .toArray(),
    [formattedSelectedDate]
  );

  const handleSelectGoal = async (goalId: number | null) => {
    // ...
    const newTask: Task = {
      // ...
      date: formattedSelectedDate, // 날짜 속성 설정
      createdAt: new Date(),     // 생성 시각 설정
    };
    // ...
  };
  // ...
};
```

### 4. `src/components/TaskEditorModal.tsx` 파일 수정
- `dateUtils.ts`에서 유틸리티 함수들을 임포트했습니다.
- `selectedDate` 상태를 `Date | null`에서 `string | null` 타입으로 변경하고, `YYYY-MM-DD` 형식의 문자열로 관리하도록 했습니다.
- `useEffect` 훅에서 `taskToEdit`이 있을 경우 `taskToEdit.date`를 사용하여 `selectedDate`를 초기화하고, 없을 경우 현재 날짜를 `YYYY-MM-DD` 형식으로 초기화했습니다.
- `handleSave` 함수에서 `updatedTask.date`에 `selectedDate` 문자열을 직접 할당하도록 수정했습니다.
- `DateSelectorModal`에서 선택된 `Date` 객체를 `handleSelectNewDate`에서 `YYYY-MM-DD` 문자열로 변환하여 `selectedDate` 상태에 저장하도록 했습니다.
- 날짜 표시를 위한 `formatDateForDisplay` 함수를 업데이트하여 `YYYY-MM-DD` 문자열을 받아 사용자 친화적인 형식으로 변환하도록 했습니다.
- 기존 `Task` 인터페이스에서 제거된 `description` 필드와 관련된 UI (textarea) 및 상태 관리 로직을 제거했습니다.

```typescript
// src/components/TaskEditorModal.tsx (변경 내용 요약)
// import { formatDateToYYYYMMDD, parseYYYYMMDDToDate } from '../utils/dateUtils';
const TaskEditorModal: React.FC<TaskEditorModalProps> = ({ isOpen, onClose, taskToEdit, onSave }) => {
  const [selectedDate, setSelectedDate] = useState<string | null>(formatDateToYYYYMMDD(new Date()));
  // ...
  useEffect(() => {
    if (taskToEdit) {
      setSelectedDate(taskToEdit.date);
    } else {
      setSelectedDate(formatDateToYYYYMMDD(new Date()));
    }
  }, [taskToEdit]);
  // ...
  const handleSave = async () => {
    // ...
    const updatedTask: Task = {
      // ...
      date: selectedDate,
      // ...
    };
    // ...
  };
  // ...
  const handleSelectNewDate = (date: Date) => {
    setSelectedDate(formatDateToYYYYMMDD(date));
    // ...
  };
  // ...
  const formatDateForDisplay = (dateString: string | null) => { /* ... */ };
  // Removed description textarea
  // ...
};
```

### 5. 테스트
- 프로젝트에 별도의 테스트 프레임워크 설정이 없어 자동화된 단위 테스트를 추가하지 못했습니다. 대신, 사용자에게 애플리케이션을 실행하여 수동으로 기능 변경 사항을 확인할 것을 안내했습니다.

### 6. 커밋
- 위의 모든 변경 사항은 하나의 커밋으로 저장되었습니다.
  `feat: Implement task filtering by date`
